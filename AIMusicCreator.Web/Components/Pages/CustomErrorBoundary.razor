@using Microsoft.AspNetCore.Components.Web

<CascadingValue Value="this">
    @ChildContent
</CascadingValue>

@if (CurrentException != null)
{
    <div class="alert alert-danger">
        <h4>发生错误</h4>
        <p>@CurrentException.Message</p>
        <button @onclick="Recover" class="btn btn-primary">重试</button>
    </div>
}

@code {
    [Parameter] public RenderFragment? ChildContent { get; set; }

    public Exception? CurrentException { get; private set; }

    public void Recover()
    {
        CurrentException = null;
        StateHasChanged();
    }

    public void ReportError(Exception exception)
    {
        CurrentException = exception;
        StateHasChanged();
    }
}